(require (lib "48.ss" "srfi"))
(require (lib "etc.ss"))
(require (lib "list.ss"))
(require (lib "math.ss"))

(define (ev e)
  (cond ((list? e)
         (let ((p (car e))
               (x (ev (cadr e)))
               (y (ev (caddr e))))
           (+ (* p (+ x y)) (* (- 1 p) (- x y)))))
        (#t e)))
(define (go)
  (let ((r (read)))
    (if (empty? r) '()
        (begin
          (format (current-output-port) "~0,2F\n" (ev r))
          (go)))))
(go)
